ASxxxx Assembler V02.00 + NoICE + SDCC mods  (Zilog Z80 / Hitachi HD64180), page 1.
Hexadecimal [16-Bits]



                              1 ;******************************
                              2 ; 	void set_stack(unsigned char x1,unsigned char y1,unsigned char w1,unsigned char h1,unsigned char x2,unsigned char y2,unsigned char w2,unsigned char h2){
                              3 ; 	Descripción:	Reubica la pila 
                              4 ;	Entrada:	Dirección en la que se reubica la pila
                              5 ;	Salida:		Ninguna
                              6 ;	Modificados: 
                              7 ;
                              8 ; @JohnLobo Nov15  
                              9 ;******************************
                             10 .globl _set_stack
   0000                      11 _set_stack::
   0000 C1            [10]   12 	pop bc
   0001 E1            [10]   13 	pop hl
   0002 F9            [ 6]   14 	ld sp, hl
   0003 E5            [11]   15 	push hl
   0004 C5            [11]   16 	push bc
   0005 C9            [10]   17 	ret
                             18 
                             19 ;******************************
                             20 ; 	unsigned char fastCollision(unsigned char x1,unsigned char y1,unsigned char w1,unsigned char h1,unsigned char x2,unsigned char y2,unsigned char w2,unsigned char h2){
                             21 ; 	Descripción:	Devuelve 1 si se ha producido una colisión y 0 en caso contrario
                             22 ;	Entrada:	- Coordenada x objeto 1
                             23 ;				- Coordenada y objeto 1
                             24 ;				- Ancho objeto 1
                             25 ;				- Alto objeto 1
                             26 ;				- Coordenada x objeto 1
                             27 ;				- Coordenada y objeto 1
                             28 ;				- Ancho objeto 1
                             29 ;				- Alto objeto 1
                             30 ;	Salida:		- HL = 1 si se ha producido una colisión, HL = 0 en caso contrario
                             31 ;	Modificados: 
                             32 ;
                             33 ; @JohnLobo Nov15  
                             34 ;******************************
                             35 .globl _fast_collision
   0006                      36 _fast_collision::	
                             37 
   0006 DD E5         [15]   38 	push ix
                             39 
                             40 ;	ld ix,#2
   0008 DD 21 04 00   [14]   41 	ld ix,#4
   000C DD 39         [15]   42 	add ix,sp
                             43 	
   000E DD 7E 00      [19]   44 	ld a,0 (ix)				;recupero la coordenada x1
   0011 67            [ 4]   45 	ld h,a
   0012 DD 7E 02      [19]   46 	ld a,2 (ix)				;recupero el ancho 1
   0015 84            [ 4]   47 	add a,h
   0016 6F            [ 4]   48 	ld l,a
   0017 DD 7E 04      [19]   49 	ld a,4 (ix)				;recupero la coordenada x2
   001A 47            [ 4]   50 	ld b,a
   001B DD 7E 06      [19]   51 	ld a,6 (ix)				;recupero el ancho 2
   001E 80            [ 4]   52 	add a,b
   001F 4F            [ 4]   53 	ld c,a
   0020 CD 4A 00      [17]   54 	call #solseg
   0023 30 1E         [12]   55 	jr nc, no_choca
ASxxxx Assembler V02.00 + NoICE + SDCC mods  (Zilog Z80 / Hitachi HD64180), page 2.
Hexadecimal [16-Bits]



   0025 DD 7E 01      [19]   56 	ld a,1 (ix)				;recupero la coordenada y1
   0028 67            [ 4]   57 	ld h,a
   0029 DD 7E 03      [19]   58 	ld a,3 (ix)				;recupero el alto 1
   002C 84            [ 4]   59 	add a,h
   002D 6F            [ 4]   60 	ld l,a
   002E DD 7E 05      [19]   61 	ld a,5 (ix)				;recupero la coordenada y2
   0031 47            [ 4]   62 	ld b,a
   0032 DD 7E 07      [19]   63 	ld a,7 (ix)				;recupero el alto 2
   0035 80            [ 4]   64 	add a,b
   0036 4F            [ 4]   65 	ld c,a
   0037 CD 4A 00      [17]   66 	call #solseg
   003A 30 07         [12]   67 	jr nc, no_choca
   003C 26 00         [ 7]   68 	ld h,#0
   003E 2E 01         [ 7]   69 	ld l,#1
                             70 
   0040 DD E1         [14]   71 	pop ix
                             72 
   0042 C9            [10]   73 	ret
   0043                      74 no_choca:
   0043 26 00         [ 7]   75 	ld h,#0
   0045 2E 00         [ 7]   76 	ld l,#0
                             77 
   0047 DD E1         [14]   78 	pop ix
                             79 
   0049 C9            [10]   80 	ret
                             81 
   004A                      82 solseg:
   004A 79            [ 4]   83 	ld a,c					;solapamaiento
   004B BC            [ 4]   84 	cp h
   004C 38 02         [12]   85 	jr c, #solseg1			;no hay colisión continua
   004E 7D            [ 4]   86 	ld a,l
   004F B8            [ 4]   87 	cp b
   0050                      88 solseg1:
   0050 3F            [ 4]   89 	ccf						;complemento carry
   0051 C9            [10]   90 	ret
