                              1 ;--------------------------------------------------------
                              2 ; File Created by SDCC : free open source ANSI-C Compiler
                              3 ; Version 3.5.0 #9253 (Aug  4 2015) (Mac OS X x86_64)
                              4 ; This file was generated Sun Aug 16 00:46:06 2015
                              5 ;--------------------------------------------------------
                              6 	.module main
                              7 	.optsdcc -mz80
                              8 	
                              9 ;--------------------------------------------------------
                             10 ; Public variables in this module
                             11 ;--------------------------------------------------------
                             12 	.globl _main
                             13 	.globl _game
                             14 	.globl _game_over
                             15 	.globl _win
                             16 	.globl _help
                             17 	.globl _end
                             18 	.globl _level_up
                             19 	.globl _redefine_keys
                             20 	.globl _menu
                             21 	.globl _init_level
                             22 	.globl _init_game
                             23 	.globl _initial_setup
                             24 	.globl _initialization
                             25 	.globl _draw_scoreboard
                             26 	.globl _clear_both_screens
                             27 	.globl _clear_screen
                             28 	.globl _changeVideoMemoryPage
                             29 	.globl _get_time
                             30 	.globl _timer_off
                             31 	.globl _timer_on
                             32 	.globl _set_stack
                             33 	.globl _cpc_PrintGphStr2X
                             34 	.globl _cpc_PrintGphStr
                             35 	.globl _update_stars
                             36 	.globl _draw_stars
                             37 	.globl _init_stars
                             38 	.globl _get_last_moved_stars
                             39 	.globl _draw_messages
                             40 	.globl _create_message
                             41 	.globl _init_messages
                             42 	.globl _colour_message
                             43 	.globl _red_message
                             44 	.globl _blue_message
                             45 	.globl _draw_explosions
                             46 	.globl _update_explosions
                             47 	.globl _init_explosions
                             48 	.globl _get_score
                             49 	.globl _set_score
                             50 	.globl _draw_user
                             51 	.globl _update_user
                             52 	.globl _user_engine
                             53 	.globl _get_user_speed
                             54 	.globl _user_init_level
                             55 	.globl _init_user
                             56 	.globl _get_last_moved_user
                             57 	.globl _draw_enemies
                             58 	.globl _update_enemies
                             59 	.globl _init_enemies
                             60 	.globl _draw_shoots
                             61 	.globl _update_shoots
                             62 	.globl _init_shoots
                             63 	.globl _cpct_setRandomSeedUniform_u8
                             64 	.globl _cpct_getScreenPtr
                             65 	.globl _cpct_setVideoMemoryPage
                             66 	.globl _cpct_setPALColour
                             67 	.globl _cpct_setPalette
                             68 	.globl _cpct_fw2hw
                             69 	.globl _cpct_setVideoMode
                             70 	.globl _cpct_isKeyPressed
                             71 	.globl _cpct_scanKeyboard_f
                             72 	.globl _cpct_memset_f64
                             73 	.globl _cpct_disableFirmware
                             74 	.globl _sprintf
                             75 	.globl _level
                             76 	.globl _aux_txt
                             77 	.globl _pvmem
                             78 	.globl _previous_state
                             79 	.globl _state
                             80 ;--------------------------------------------------------
                             81 ; special function registers
                             82 ;--------------------------------------------------------
                             83 ;--------------------------------------------------------
                             84 ; ram data
                             85 ;--------------------------------------------------------
                             86 	.area _DATA
   0000                      87 _state::
   0000                      88 	.ds 1
   0001                      89 _previous_state::
   0001                      90 	.ds 1
   0002                      91 _pvmem::
   0002                      92 	.ds 2
   0004                      93 _aux_txt::
   0004                      94 	.ds 40
   002C                      95 _changeVideoMemoryPage_page_1_89:
   002C                      96 	.ds 1
                             97 ;--------------------------------------------------------
                             98 ; ram data
                             99 ;--------------------------------------------------------
                            100 	.area _INITIALIZED
   0000                     101 _level::
   0000                     102 	.ds 1
                            103 ;--------------------------------------------------------
                            104 ; absolute external ram data
                            105 ;--------------------------------------------------------
                            106 	.area _DABS (ABS)
                            107 ;--------------------------------------------------------
                            108 ; global & static initialisations
                            109 ;--------------------------------------------------------
                            110 	.area _HOME
                            111 	.area _GSINIT
                            112 	.area _GSFINAL
                            113 	.area _GSINIT
                            114 ;src/main.c:52: static u8 page   = 0;   // Static value to remember the last page shown (0 = page 40, 1 = page C0)
   0000 FD 21r2Cr00   [14]  115 	ld	iy,#_changeVideoMemoryPage_page_1_89
   0004 FD 36 00 00   [19]  116 	ld	0 (iy),#0x00
                            117 ;--------------------------------------------------------
                            118 ; Home
                            119 ;--------------------------------------------------------
                            120 	.area _HOME
                            121 	.area _HOME
                            122 ;--------------------------------------------------------
                            123 ; code
                            124 ;--------------------------------------------------------
                            125 	.area _CODE
                            126 ;src/main.c:51: u8* changeVideoMemoryPage() {
                            127 ;	---------------------------------
                            128 ; Function changeVideoMemoryPage
                            129 ; ---------------------------------
   0000                     130 _changeVideoMemoryPage::
                            131 ;src/main.c:57: if (page) {
   0000 3Ar2Cr00      [13]  132 	ld	a,(#_changeVideoMemoryPage_page_1_89 + 0)
   0003 B7            [ 4]  133 	or	a, a
   0004 28 0E         [12]  134 	jr	Z,00102$
                            135 ;src/main.c:58: cpct_setVideoMemoryPage(cpct_pageC0);  // Set video memory at banck 3 (0xC000 - 0xFFFF)
   0006 2E 30         [ 7]  136 	ld	l,#0x30
   0008 CDr00r00      [17]  137 	call	_cpct_setVideoMemoryPage
                            138 ;src/main.c:59: page = 0;  
   000B 21r2Cr00      [10]  139 	ld	hl,#_changeVideoMemoryPage_page_1_89 + 0
   000E 36 00         [10]  140 	ld	(hl), #0x00
                            141 ;src/main.c:60: screen = SCR_BUFF;                            // Next page = 0
   0010 21 00 80      [10]  142 	ld	hl,#0x8000
   0013 C9            [10]  143 	ret
   0014                     144 00102$:
                            145 ;src/main.c:62: cpct_setVideoMemoryPage(cpct_page80);  // Set video memory at banck 1 (0x8000 - 0x7FFF)
   0014 2E 20         [ 7]  146 	ld	l,#0x20
   0016 CDr00r00      [17]  147 	call	_cpct_setVideoMemoryPage
                            148 ;src/main.c:63: page = 1;                              // Next page = 1
   0019 21r2Cr00      [10]  149 	ld	hl,#_changeVideoMemoryPage_page_1_89 + 0
   001C 36 01         [10]  150 	ld	(hl), #0x01
                            151 ;src/main.c:64: screen = SCR_VMEM;
   001E 21 00 C0      [10]  152 	ld	hl,#0xC000
                            153 ;src/main.c:66: return screen;
   0021 C9            [10]  154 	ret
                            155 ;src/main.c:73: void clear_screen(u8* screen){
                            156 ;	---------------------------------
                            157 ; Function clear_screen
                            158 ; ---------------------------------
   0022                     159 _clear_screen::
                            160 ;src/main.c:74: cpct_memset_f64(screen, 0x00, 0x4000);   
   0022 C1            [10]  161 	pop	bc
   0023 E1            [10]  162 	pop	hl
   0024 E5            [11]  163 	push	hl
   0025 C5            [11]  164 	push	bc
   0026 01 00 40      [10]  165 	ld	bc,#0x4000
   0029 C5            [11]  166 	push	bc
   002A 01 00 00      [10]  167 	ld	bc,#0x0000
   002D C5            [11]  168 	push	bc
   002E E5            [11]  169 	push	hl
   002F CDr00r00      [17]  170 	call	_cpct_memset_f64
   0032 C9            [10]  171 	ret
                            172 ;src/main.c:80: void clear_both_screens(){
                            173 ;	---------------------------------
                            174 ; Function clear_both_screens
                            175 ; ---------------------------------
   0033                     176 _clear_both_screens::
                            177 ;src/main.c:81: cpct_memset_f64(SCR_VMEM, 0x00, 0x4000);   
   0033 21 00 40      [10]  178 	ld	hl,#0x4000
   0036 E5            [11]  179 	push	hl
   0037 26 00         [ 7]  180 	ld	h, #0x00
   0039 E5            [11]  181 	push	hl
   003A 26 C0         [ 7]  182 	ld	h, #0xC0
   003C E5            [11]  183 	push	hl
   003D CDr00r00      [17]  184 	call	_cpct_memset_f64
                            185 ;src/main.c:82: cpct_memset_f64(SCR_BUFF, 0x00, 0x4000);   
   0040 21 00 40      [10]  186 	ld	hl,#0x4000
   0043 E5            [11]  187 	push	hl
   0044 26 00         [ 7]  188 	ld	h, #0x00
   0046 E5            [11]  189 	push	hl
   0047 26 80         [ 7]  190 	ld	h, #0x80
   0049 E5            [11]  191 	push	hl
   004A CDr00r00      [17]  192 	call	_cpct_memset_f64
   004D C9            [10]  193 	ret
                            194 ;src/main.c:89: void draw_scoreboard(u8* screen){
                            195 ;	---------------------------------
                            196 ; Function draw_scoreboard
                            197 ; ---------------------------------
   004E                     198 _draw_scoreboard::
   004E DD E5         [15]  199 	push	ix
   0050 DD 21 00 00   [14]  200 	ld	ix,#0
   0054 DD 39         [15]  201 	add	ix,sp
                            202 ;src/main.c:90: sprintf(aux_txt,"%08d",get_score());
   0056 CDr00r00      [17]  203 	call	_get_score
   0059 D5            [11]  204 	push	de
   005A E5            [11]  205 	push	hl
   005B 21rA7r00      [10]  206 	ld	hl,#___str_0
   005E E5            [11]  207 	push	hl
   005F 21r04r00      [10]  208 	ld	hl,#_aux_txt
   0062 E5            [11]  209 	push	hl
   0063 CDr00r00      [17]  210 	call	_sprintf
   0066 21 08 00      [10]  211 	ld	hl,#8
   0069 39            [11]  212 	add	hl,sp
   006A F9            [ 6]  213 	ld	sp,hl
                            214 ;src/main.c:91: colour_message(0, 2);
   006B 21 00 02      [10]  215 	ld	hl,#0x0200
   006E E5            [11]  216 	push	hl
   006F CDr00r00      [17]  217 	call	_colour_message
   0072 F1            [10]  218 	pop	af
                            219 ;src/main.c:92: cpc_PrintGphStr(aux_txt,(int) cpct_getScreenPtr(screen, 4, 8));
   0073 DD 5E 04      [19]  220 	ld	e,4 (ix)
   0076 DD 56 05      [19]  221 	ld	d,5 (ix)
   0079 D5            [11]  222 	push	de
   007A 21 04 08      [10]  223 	ld	hl,#0x0804
   007D E5            [11]  224 	push	hl
   007E D5            [11]  225 	push	de
   007F CDr00r00      [17]  226 	call	_cpct_getScreenPtr
   0082 D1            [10]  227 	pop	de
   0083 01r04r00      [10]  228 	ld	bc,#_aux_txt
   0086 D5            [11]  229 	push	de
   0087 E5            [11]  230 	push	hl
   0088 C5            [11]  231 	push	bc
   0089 CDr00r00      [17]  232 	call	_cpc_PrintGphStr
   008C F1            [10]  233 	pop	af
   008D F1            [10]  234 	pop	af
   008E CDr00r00      [17]  235 	call	_red_message
   0091 D1            [10]  236 	pop	de
                            237 ;src/main.c:94: cpc_PrintGphStr("00000000",(int) cpct_getScreenPtr(screen, 60, 8));
   0092 21 3C 08      [10]  238 	ld	hl,#0x083C
   0095 E5            [11]  239 	push	hl
   0096 D5            [11]  240 	push	de
   0097 CDr00r00      [17]  241 	call	_cpct_getScreenPtr
   009A 11rACr00      [10]  242 	ld	de,#___str_1+0
   009D E5            [11]  243 	push	hl
   009E D5            [11]  244 	push	de
   009F CDr00r00      [17]  245 	call	_cpc_PrintGphStr
   00A2 F1            [10]  246 	pop	af
   00A3 F1            [10]  247 	pop	af
   00A4 DD E1         [14]  248 	pop	ix
   00A6 C9            [10]  249 	ret
   00A7                     250 ___str_0:
   00A7 25 30 38 64         251 	.ascii "%08d"
   00AB 00                  252 	.db 0x00
   00AC                     253 ___str_1:
   00AC 30 30 30 30 30 30   254 	.ascii "00000000"
        30 30
   00B4 00                  255 	.db 0x00
                            256 ;src/main.c:101: void initialization(){
                            257 ;	---------------------------------
                            258 ; Function initialization
                            259 ; ---------------------------------
   00B5                     260 _initialization::
                            261 ;src/main.c:103: pvmem = SCR_BUFF;
   00B5 21 00 80      [10]  262 	ld	hl,#0x8000
   00B8 22r02r00      [16]  263 	ld	(_pvmem),hl
                            264 ;src/main.c:105: clear_both_screens();
   00BB CDr33r00      [17]  265 	call	_clear_both_screens
                            266 ;src/main.c:107: cpct_setRandomSeedUniform_u8((u8) get_time());
   00BE CDr00r00      [17]  267 	call	_get_time
   00C1 CDr00r00      [17]  268 	call	_cpct_setRandomSeedUniform_u8
                            269 ;src/main.c:110: init_stars();
   00C4 CDr00r00      [17]  270 	call	_init_stars
                            271 ;src/main.c:112: init_user();
   00C7 CDr00r00      [17]  272 	call	_init_user
                            273 ;src/main.c:113: init_shoots();
   00CA CDr00r00      [17]  274 	call	_init_shoots
                            275 ;src/main.c:114: init_enemies();
   00CD CDr00r00      [17]  276 	call	_init_enemies
                            277 ;src/main.c:115: init_explosions();
   00D0 CDr00r00      [17]  278 	call	_init_explosions
                            279 ;src/main.c:116: init_messages();
   00D3 C3r00r00      [10]  280 	jp  _init_messages
                            281 ;src/main.c:121: void initial_setup(){
                            282 ;	---------------------------------
                            283 ; Function initial_setup
                            284 ; ---------------------------------
   00D6                     285 _initial_setup::
                            286 ;src/main.c:122: cpct_disableFirmware();  // Disable firmware to prevent it from interfering
   00D6 CDr00r00      [17]  287 	call	_cpct_disableFirmware
                            288 ;src/main.c:124: cpct_fw2hw       (palette, 16);   // Convert Firmware colours to Hardware colours 
   00D9 11r00r00      [10]  289 	ld	de,#_palette
   00DC 3E 10         [ 7]  290 	ld	a,#0x10
   00DE F5            [11]  291 	push	af
   00DF 33            [ 6]  292 	inc	sp
   00E0 D5            [11]  293 	push	de
   00E1 CDr00r00      [17]  294 	call	_cpct_fw2hw
   00E4 F1            [10]  295 	pop	af
   00E5 33            [ 6]  296 	inc	sp
                            297 ;src/main.c:125: cpct_setPalette  (palette, 16);   // Set up palette using hardware colours
   00E6 11r00r00      [10]  298 	ld	de,#_palette
   00E9 3E 10         [ 7]  299 	ld	a,#0x10
   00EB F5            [11]  300 	push	af
   00EC 33            [ 6]  301 	inc	sp
   00ED D5            [11]  302 	push	de
   00EE CDr00r00      [17]  303 	call	_cpct_setPalette
   00F1 F1            [10]  304 	pop	af
   00F2 33            [ 6]  305 	inc	sp
                            306 ;src/main.c:126: cpct_setBorder   (palette[0]);    // Set up the border to the background colour (white)
   00F3 3Ar00r00      [13]  307 	ld	a, (#_palette + 0)
   00F6 57            [ 4]  308 	ld	d,a
   00F7 1E 10         [ 7]  309 	ld	e,#0x10
   00F9 D5            [11]  310 	push	de
   00FA CDr00r00      [17]  311 	call	_cpct_setPALColour
                            312 ;src/main.c:127: cpct_setVideoMode(0);               // Change to Mode 0 (160x200, 16 colours)
   00FD AF            [ 4]  313 	xor	a, a
   00FE F5            [11]  314 	push	af
   00FF 33            [ 6]  315 	inc	sp
   0100 CDr00r00      [17]  316 	call	_cpct_setVideoMode
   0103 33            [ 6]  317 	inc	sp
                            318 ;src/main.c:130: clear_both_screens();
   0104 CDr33r00      [17]  319 	call	_clear_both_screens
                            320 ;src/main.c:131: state=INITIAL_STATE;
   0107 21r00r00      [10]  321 	ld	hl,#_state + 0
   010A 36 02         [10]  322 	ld	(hl), #0x02
   010C C9            [10]  323 	ret
                            324 ;src/main.c:134: void init_game(){
                            325 ;	---------------------------------
                            326 ; Function init_game
                            327 ; ---------------------------------
   010D                     328 _init_game::
                            329 ;src/main.c:136: }
   010D C9            [10]  330 	ret
                            331 ;src/main.c:138: void init_level(){
                            332 ;	---------------------------------
                            333 ; Function init_level
                            334 ; ---------------------------------
   010E                     335 _init_level::
                            336 ;src/main.c:140: }
   010E C9            [10]  337 	ret
                            338 ;src/main.c:142: u8 menu(){
                            339 ;	---------------------------------
                            340 ; Function menu
                            341 ; ---------------------------------
   010F                     342 _menu::
                            343 ;src/main.c:143: u8 choice=0;
   010F 0E 00         [ 7]  344 	ld	c,#0x00
                            345 ;src/main.c:145: clear_screen(SCR_VMEM);
   0111 C5            [11]  346 	push	bc
   0112 21 00 C0      [10]  347 	ld	hl,#0xC000
   0115 E5            [11]  348 	push	hl
   0116 CDr22r00      [17]  349 	call	_clear_screen
   0119 F1            [10]  350 	pop	af
   011A CDr00r00      [17]  351 	call	_red_message
   011D 21 14 10      [10]  352 	ld	hl,#0x1014
   0120 E5            [11]  353 	push	hl
   0121 21 00 C0      [10]  354 	ld	hl,#0xC000
   0124 E5            [11]  355 	push	hl
   0125 CDr00r00      [17]  356 	call	_cpct_getScreenPtr
   0128 C1            [10]  357 	pop	bc
   0129 11rF1r01      [10]  358 	ld	de,#___str_2+0
   012C C5            [11]  359 	push	bc
   012D E5            [11]  360 	push	hl
   012E D5            [11]  361 	push	de
   012F CDr00r00      [17]  362 	call	_cpc_PrintGphStr2X
   0132 F1            [10]  363 	pop	af
   0133 F1            [10]  364 	pop	af
   0134 CDr00r00      [17]  365 	call	_blue_message
   0137 21 1C 40      [10]  366 	ld	hl,#0x401C
   013A E5            [11]  367 	push	hl
   013B 21 00 C0      [10]  368 	ld	hl,#0xC000
   013E E5            [11]  369 	push	hl
   013F CDr00r00      [17]  370 	call	_cpct_getScreenPtr
   0142 C1            [10]  371 	pop	bc
   0143 11r06r02      [10]  372 	ld	de,#___str_3+0
   0146 C5            [11]  373 	push	bc
   0147 E5            [11]  374 	push	hl
   0148 D5            [11]  375 	push	de
   0149 CDr00r00      [17]  376 	call	_cpc_PrintGphStr
   014C F1            [10]  377 	pop	af
   014D 21 1C 50      [10]  378 	ld	hl, #0x501C
   0150 E3            [19]  379 	ex	(sp),hl
   0151 21 00 C0      [10]  380 	ld	hl,#0xC000
   0154 E5            [11]  381 	push	hl
   0155 CDr00r00      [17]  382 	call	_cpct_getScreenPtr
   0158 C1            [10]  383 	pop	bc
   0159 11r0Er02      [10]  384 	ld	de,#___str_4+0
   015C C5            [11]  385 	push	bc
   015D E5            [11]  386 	push	hl
   015E D5            [11]  387 	push	de
   015F CDr00r00      [17]  388 	call	_cpc_PrintGphStr
   0162 F1            [10]  389 	pop	af
   0163 21 1C 60      [10]  390 	ld	hl, #0x601C
   0166 E3            [19]  391 	ex	(sp),hl
   0167 21 00 C0      [10]  392 	ld	hl,#0xC000
   016A E5            [11]  393 	push	hl
   016B CDr00r00      [17]  394 	call	_cpct_getScreenPtr
   016E C1            [10]  395 	pop	bc
   016F 11r16r02      [10]  396 	ld	de,#___str_5+0
   0172 C5            [11]  397 	push	bc
   0173 E5            [11]  398 	push	hl
   0174 D5            [11]  399 	push	de
   0175 CDr00r00      [17]  400 	call	_cpc_PrintGphStr
   0178 F1            [10]  401 	pop	af
   0179 21 1C 70      [10]  402 	ld	hl, #0x701C
   017C E3            [19]  403 	ex	(sp),hl
   017D 21 00 C0      [10]  404 	ld	hl,#0xC000
   0180 E5            [11]  405 	push	hl
   0181 CDr00r00      [17]  406 	call	_cpct_getScreenPtr
   0184 C1            [10]  407 	pop	bc
   0185 11r29r02      [10]  408 	ld	de,#___str_6+0
   0188 C5            [11]  409 	push	bc
   0189 E5            [11]  410 	push	hl
   018A D5            [11]  411 	push	de
   018B CDr00r00      [17]  412 	call	_cpc_PrintGphStr
   018E F1            [10]  413 	pop	af
   018F F1            [10]  414 	pop	af
   0190 CDr00r00      [17]  415 	call	_red_message
   0193 21 14 A0      [10]  416 	ld	hl,#0xA014
   0196 E5            [11]  417 	push	hl
   0197 21 00 C0      [10]  418 	ld	hl,#0xC000
   019A E5            [11]  419 	push	hl
   019B CDr00r00      [17]  420 	call	_cpct_getScreenPtr
   019E C1            [10]  421 	pop	bc
   019F 11r33r02      [10]  422 	ld	de,#___str_7+0
   01A2 C5            [11]  423 	push	bc
   01A3 E5            [11]  424 	push	hl
   01A4 D5            [11]  425 	push	de
   01A5 CDr00r00      [17]  426 	call	_cpc_PrintGphStr
   01A8 F1            [10]  427 	pop	af
   01A9 F1            [10]  428 	pop	af
   01AA C1            [10]  429 	pop	bc
                            430 ;src/main.c:157: while (choice==0) {
   01AB                     431 00109$:
   01AB 79            [ 4]  432 	ld	a,c
   01AC B7            [ 4]  433 	or	a, a
   01AD 20 40         [12]  434 	jr	NZ,00111$
                            435 ;src/main.c:159: cpct_scanKeyboard_f();
   01AF C5            [11]  436 	push	bc
   01B0 CDr00r00      [17]  437 	call	_cpct_scanKeyboard_f
   01B3 21 08 01      [10]  438 	ld	hl,#0x0108
   01B6 CDr00r00      [17]  439 	call	_cpct_isKeyPressed
   01B9 7D            [ 4]  440 	ld	a,l
   01BA C1            [10]  441 	pop	bc
   01BB B7            [ 4]  442 	or	a, a
   01BC 28 05         [12]  443 	jr	Z,00102$
                            444 ;src/main.c:162: init_game();
   01BE CDr0Dr01      [17]  445 	call	_init_game
                            446 ;src/main.c:163: choice=STATE_GAME;
   01C1 0E 04         [ 7]  447 	ld	c,#0x04
   01C3                     448 00102$:
                            449 ;src/main.c:165: if (cpct_isKeyPressed(Key_2))    
   01C3 C5            [11]  450 	push	bc
   01C4 21 08 02      [10]  451 	ld	hl,#0x0208
   01C7 CDr00r00      [17]  452 	call	_cpct_isKeyPressed
   01CA 7D            [ 4]  453 	ld	a,l
   01CB C1            [10]  454 	pop	bc
   01CC B7            [ 4]  455 	or	a, a
   01CD 28 02         [12]  456 	jr	Z,00104$
                            457 ;src/main.c:166: choice=STATE_HELP;
   01CF 0E 03         [ 7]  458 	ld	c,#0x03
   01D1                     459 00104$:
                            460 ;src/main.c:167: if (cpct_isKeyPressed(Key_3))    
   01D1 C5            [11]  461 	push	bc
   01D2 21 07 02      [10]  462 	ld	hl,#0x0207
   01D5 CDr00r00      [17]  463 	call	_cpct_isKeyPressed
   01D8 7D            [ 4]  464 	ld	a,l
   01D9 C1            [10]  465 	pop	bc
   01DA B7            [ 4]  466 	or	a, a
   01DB 28 02         [12]  467 	jr	Z,00106$
                            468 ;src/main.c:168: choice=STATE_REDEFINE;
   01DD 0E 09         [ 7]  469 	ld	c,#0x09
   01DF                     470 00106$:
                            471 ;src/main.c:169: if (cpct_isKeyPressed(Key_Esc)){    
   01DF C5            [11]  472 	push	bc
   01E0 21 08 04      [10]  473 	ld	hl,#0x0408
   01E3 CDr00r00      [17]  474 	call	_cpct_isKeyPressed
   01E6 7D            [ 4]  475 	ld	a,l
   01E7 C1            [10]  476 	pop	bc
   01E8 B7            [ 4]  477 	or	a, a
   01E9 28 C0         [12]  478 	jr	Z,00109$
                            479 ;src/main.c:170: choice=STATE_EXIT;
   01EB 0E 05         [ 7]  480 	ld	c,#0x05
   01ED 18 BC         [12]  481 	jr	00109$
   01EF                     482 00111$:
                            483 ;src/main.c:173: return choice; 
   01EF 69            [ 4]  484 	ld	l,c
   01F0 C9            [10]  485 	ret
   01F1                     486 ___str_2:
   01F1 53 50 41 43 45 3B   487 	.ascii "SPACE;RETRO;INVADERS"
        52 45 54 52 4F 3B
        49 4E 56 41 44 45
        52 53
   0205 00                  488 	.db 0x00
   0206                     489 ___str_3:
   0206 31 3B 4A 55 47 41   490 	.ascii "1;JUGAR"
        52
   020D 00                  491 	.db 0x00
   020E                     492 ___str_4:
   020E 32 3B 41 59 55 44   493 	.ascii "2;AYUDA"
        41
   0215 00                  494 	.db 0x00
   0216                     495 ___str_5:
   0216 33 3B 52 45 44 45   496 	.ascii "3;REDEFINIR;TECLAS"
        46 49 4E 49 52 3B
        54 45 43 4C 41 53
   0228 00                  497 	.db 0x00
   0229                     498 ___str_6:
   0229 45 53 43 3B 53 41   499 	.ascii "ESC;SALIR"
        4C 49 52
   0232 00                  500 	.db 0x00
   0233                     501 ___str_7:
   0233 43 3B 32 30 31 35   502 	.ascii "C;2015;JOHN;LOBO"
        3B 4A 4F 48 4E 3B
        4C 4F 42 4F
   0243 00                  503 	.db 0x00
                            504 ;src/main.c:176: u8 redefine_keys(){
                            505 ;	---------------------------------
                            506 ; Function redefine_keys
                            507 ; ---------------------------------
   0244                     508 _redefine_keys::
                            509 ;src/main.c:178: return STATE_MENU;
   0244 2E 02         [ 7]  510 	ld	l,#0x02
   0246 C9            [10]  511 	ret
                            512 ;src/main.c:182: u8 level_up(){
                            513 ;	---------------------------------
                            514 ; Function level_up
                            515 ; ---------------------------------
   0247                     516 _level_up::
                            517 ;src/main.c:184: return STATE_MENU;
   0247 2E 02         [ 7]  518 	ld	l,#0x02
   0249 C9            [10]  519 	ret
                            520 ;src/main.c:188: u8 end(){
                            521 ;	---------------------------------
                            522 ; Function end
                            523 ; ---------------------------------
   024A                     524 _end::
                            525 ;src/main.c:190: return STATE_MENU;
   024A 2E 02         [ 7]  526 	ld	l,#0x02
   024C C9            [10]  527 	ret
                            528 ;src/main.c:194: u8 help(){
                            529 ;	---------------------------------
                            530 ; Function help
                            531 ; ---------------------------------
   024D                     532 _help::
                            533 ;src/main.c:196: return STATE_MENU;
   024D 2E 02         [ 7]  534 	ld	l,#0x02
   024F C9            [10]  535 	ret
                            536 ;src/main.c:200: u8 win(){
                            537 ;	---------------------------------
                            538 ; Function win
                            539 ; ---------------------------------
   0250                     540 _win::
                            541 ;src/main.c:202: return STATE_MENU;
   0250 2E 02         [ 7]  542 	ld	l,#0x02
   0252 C9            [10]  543 	ret
                            544 ;src/main.c:206: u8 game_over(){
                            545 ;	---------------------------------
                            546 ; Function game_over
                            547 ; ---------------------------------
   0253                     548 _game_over::
                            549 ;src/main.c:208: return STATE_LOSE;
   0253 2E 07         [ 7]  550 	ld	l,#0x07
   0255 C9            [10]  551 	ret
                            552 ;src/main.c:212: u8 game(){
                            553 ;	---------------------------------
                            554 ; Function game
                            555 ; ---------------------------------
   0256                     556 _game::
   0256 DD E5         [15]  557 	push	ix
   0258 DD 21 00 00   [14]  558 	ld	ix,#0
   025C DD 39         [15]  559 	add	ix,sp
   025E F5            [11]  560 	push	af
   025F F5            [11]  561 	push	af
                            562 ;src/main.c:214: timer_on();
   0260 CDr00r00      [17]  563 	call	_timer_on
                            564 ;src/main.c:219: initialization(); 
   0263 CDrB5r00      [17]  565 	call	_initialization
                            566 ;src/main.c:221: create_message(25,96,30,";VAMOS;AL;ATAQUE;");
   0266 21r7Ar03      [10]  567 	ld	hl,#___str_8
   0269 E5            [11]  568 	push	hl
   026A 21 60 1E      [10]  569 	ld	hl,#0x1E60
   026D E5            [11]  570 	push	hl
   026E 3E 19         [ 7]  571 	ld	a,#0x19
   0270 F5            [11]  572 	push	af
   0271 33            [ 6]  573 	inc	sp
   0272 CDr00r00      [17]  574 	call	_create_message
   0275 F1            [10]  575 	pop	af
   0276 F1            [10]  576 	pop	af
   0277 33            [ 6]  577 	inc	sp
                            578 ;src/main.c:223: init_level();
   0278 CDr0Er01      [17]  579 	call	_init_level
                            580 ;src/main.c:225: while(1)
   027B                     581 00111$:
                            582 ;src/main.c:232: if ((STARFIELD_ACTIVE) && (get_time()-get_last_moved_stars()>VELOCIDAD_ESTRELLAS)){
   027B CDr00r00      [17]  583 	call	_get_time
   027E DD 72 FF      [19]  584 	ld	-1 (ix),d
   0281 DD 73 FE      [19]  585 	ld	-2 (ix),e
   0284 DD 74 FD      [19]  586 	ld	-3 (ix),h
   0287 DD 75 FC      [19]  587 	ld	-4 (ix),l
   028A CDr00r00      [17]  588 	call	_get_last_moved_stars
   028D DD 7E FC      [19]  589 	ld	a,-4 (ix)
   0290 95            [ 4]  590 	sub	a, l
   0291 6F            [ 4]  591 	ld	l,a
   0292 DD 7E FD      [19]  592 	ld	a,-3 (ix)
   0295 9C            [ 4]  593 	sbc	a, h
   0296 67            [ 4]  594 	ld	h,a
   0297 DD 7E FE      [19]  595 	ld	a,-2 (ix)
   029A 9B            [ 4]  596 	sbc	a, e
   029B 5F            [ 4]  597 	ld	e,a
   029C DD 7E FF      [19]  598 	ld	a,-1 (ix)
   029F 9A            [ 4]  599 	sbc	a, d
   02A0 57            [ 4]  600 	ld	d,a
   02A1 3E 28         [ 7]  601 	ld	a,#0x28
   02A3 BD            [ 4]  602 	cp	a, l
   02A4 3E 00         [ 7]  603 	ld	a,#0x00
   02A6 9C            [ 4]  604 	sbc	a, h
   02A7 3E 00         [ 7]  605 	ld	a,#0x00
   02A9 9B            [ 4]  606 	sbc	a, e
   02AA 3E 00         [ 7]  607 	ld	a,#0x00
   02AC 9A            [ 4]  608 	sbc	a, d
   02AD 30 03         [12]  609 	jr	NC,00102$
                            610 ;src/main.c:233: update_stars();
   02AF CDr00r00      [17]  611 	call	_update_stars
   02B2                     612 00102$:
                            613 ;src/main.c:236: update_explosions();
   02B2 CDr00r00      [17]  614 	call	_update_explosions
                            615 ;src/main.c:238: if ((get_time()-get_last_moved_user())>get_user_speed()){
   02B5 CDr00r00      [17]  616 	call	_get_time
   02B8 DD 72 FF      [19]  617 	ld	-1 (ix),d
   02BB DD 73 FE      [19]  618 	ld	-2 (ix),e
   02BE DD 74 FD      [19]  619 	ld	-3 (ix),h
   02C1 DD 75 FC      [19]  620 	ld	-4 (ix),l
   02C4 CDr00r00      [17]  621 	call	_get_last_moved_user
   02C7 DD 7E FC      [19]  622 	ld	a,-4 (ix)
   02CA 95            [ 4]  623 	sub	a, l
   02CB DD 77 FC      [19]  624 	ld	-4 (ix),a
   02CE DD 7E FD      [19]  625 	ld	a,-3 (ix)
   02D1 9C            [ 4]  626 	sbc	a, h
   02D2 DD 77 FD      [19]  627 	ld	-3 (ix),a
   02D5 DD 7E FE      [19]  628 	ld	a,-2 (ix)
   02D8 9B            [ 4]  629 	sbc	a, e
   02D9 DD 77 FE      [19]  630 	ld	-2 (ix),a
   02DC DD 7E FF      [19]  631 	ld	a,-1 (ix)
   02DF 9A            [ 4]  632 	sbc	a, d
   02E0 DD 77 FF      [19]  633 	ld	-1 (ix),a
   02E3 CDr00r00      [17]  634 	call	_get_user_speed
   02E6 26 00         [ 7]  635 	ld	h,#0x00
   02E8 11 00 00      [10]  636 	ld	de,#0x0000
   02EB 7D            [ 4]  637 	ld	a,l
   02EC DD 96 FC      [19]  638 	sub	a, -4 (ix)
   02EF 7C            [ 4]  639 	ld	a,h
   02F0 DD 9E FD      [19]  640 	sbc	a, -3 (ix)
   02F3 7A            [ 4]  641 	ld	a,d
   02F4 DD 9E FE      [19]  642 	sbc	a, -2 (ix)
   02F7 7B            [ 4]  643 	ld	a,e
   02F8 DD 9E FF      [19]  644 	sbc	a, -1 (ix)
   02FB 30 03         [12]  645 	jr	NC,00105$
                            646 ;src/main.c:239: update_user();
   02FD CDr00r00      [17]  647 	call	_update_user
   0300                     648 00105$:
                            649 ;src/main.c:241: update_shoots();
   0300 CDr00r00      [17]  650 	call	_update_shoots
                            651 ;src/main.c:242: update_enemies();
   0303 CDr00r00      [17]  652 	call	_update_enemies
                            653 ;src/main.c:248: clear_screen(pvmem);
   0306 2Ar02r00      [16]  654 	ld	hl,(_pvmem)
   0309 E5            [11]  655 	push	hl
   030A CDr22r00      [17]  656 	call	_clear_screen
   030D F1            [10]  657 	pop	af
                            658 ;src/main.c:252: user_engine(pvmem);
   030E 2Ar02r00      [16]  659 	ld	hl,(_pvmem)
   0311 E5            [11]  660 	push	hl
   0312 CDr00r00      [17]  661 	call	_user_engine
   0315 F1            [10]  662 	pop	af
                            663 ;src/main.c:256: draw_stars(pvmem);
   0316 2Ar02r00      [16]  664 	ld	hl,(_pvmem)
   0319 E5            [11]  665 	push	hl
   031A CDr00r00      [17]  666 	call	_draw_stars
   031D F1            [10]  667 	pop	af
                            668 ;src/main.c:260: draw_user(pvmem);
   031E 2Ar02r00      [16]  669 	ld	hl,(_pvmem)
   0321 E5            [11]  670 	push	hl
   0322 CDr00r00      [17]  671 	call	_draw_user
   0325 F1            [10]  672 	pop	af
                            673 ;src/main.c:261: draw_shoots(pvmem);
   0326 2Ar02r00      [16]  674 	ld	hl,(_pvmem)
   0329 E5            [11]  675 	push	hl
   032A CDr00r00      [17]  676 	call	_draw_shoots
   032D F1            [10]  677 	pop	af
                            678 ;src/main.c:262: draw_enemies(pvmem);
   032E 2Ar02r00      [16]  679 	ld	hl,(_pvmem)
   0331 E5            [11]  680 	push	hl
   0332 CDr00r00      [17]  681 	call	_draw_enemies
   0335 F1            [10]  682 	pop	af
                            683 ;src/main.c:263: draw_explosions(pvmem);
   0336 2Ar02r00      [16]  684 	ld	hl,(_pvmem)
   0339 E5            [11]  685 	push	hl
   033A CDr00r00      [17]  686 	call	_draw_explosions
   033D F1            [10]  687 	pop	af
                            688 ;src/main.c:265: draw_messages(pvmem);
   033E 2Ar02r00      [16]  689 	ld	hl,(_pvmem)
   0341 E5            [11]  690 	push	hl
   0342 CDr00r00      [17]  691 	call	_draw_messages
   0345 F1            [10]  692 	pop	af
                            693 ;src/main.c:266: draw_scoreboard(pvmem);
   0346 2Ar02r00      [16]  694 	ld	hl,(_pvmem)
   0349 E5            [11]  695 	push	hl
   034A CDr4Er00      [17]  696 	call	_draw_scoreboard
   034D F1            [10]  697 	pop	af
                            698 ;src/main.c:274: if (cpct_isKeyPressed(Key_Esc)){     // ESC
   034E 21 08 04      [10]  699 	ld	hl,#0x0408
   0351 CDr00r00      [17]  700 	call	_cpct_isKeyPressed
   0354 7D            [ 4]  701 	ld	a,l
   0355 B7            [ 4]  702 	or	a, a
   0356 28 0A         [12]  703 	jr	Z,00109$
                            704 ;src/main.c:275: state = STATE_MENU;
   0358 FD 21r00r00   [14]  705 	ld	iy,#_state
   035C FD 36 00 02   [19]  706 	ld	0 (iy),#0x02
                            707 ;src/main.c:276: break;
   0360 18 09         [12]  708 	jr	00112$
   0362                     709 00109$:
                            710 ;src/main.c:292: pvmem = changeVideoMemoryPage();
   0362 CDr00r00      [17]  711 	call	_changeVideoMemoryPage
   0365 22r02r00      [16]  712 	ld	(_pvmem),hl
   0368 C3r7Br02      [10]  713 	jp	00111$
   036B                     714 00112$:
                            715 ;src/main.c:301: timer_off();
   036B CDr00r00      [17]  716 	call	_timer_off
                            717 ;src/main.c:303: return state;
   036E FD 21r00r00   [14]  718 	ld	iy,#_state
   0372 FD 6E 00      [19]  719 	ld	l,0 (iy)
   0375 DD F9         [10]  720 	ld	sp, ix
   0377 DD E1         [14]  721 	pop	ix
   0379 C9            [10]  722 	ret
   037A                     723 ___str_8:
   037A 3B 56 41 4D 4F 53   724 	.ascii ";VAMOS;AL;ATAQUE;"
        3B 41 4C 3B 41 54
        41 51 55 45 3B
   038B 00                  725 	.db 0x00
                            726 ;src/main.c:311: int main() {
                            727 ;	---------------------------------
                            728 ; Function main
                            729 ; ---------------------------------
   038C                     730 _main::
                            731 ;src/main.c:314: set_stack(0x1000);
   038C 21 00 10      [10]  732 	ld	hl,#0x1000
   038F E5            [11]  733 	push	hl
   0390 CDr00r00      [17]  734 	call	_set_stack
   0393 F1            [10]  735 	pop	af
                            736 ;src/main.c:316: initial_setup();
   0394 CDrD6r00      [17]  737 	call	_initial_setup
                            738 ;src/main.c:318: while (state != STATE_EXIT) {
   0397                     739 00118$:
                            740 ;src/main.c:319: switch(state) {
   0397 3Ar00r00      [13]  741 	ld	a,(#_state + 0)
   039A FE 05         [ 7]  742 	cp	a,#0x05
   039C CAr54r04      [10]  743 	jp	Z,00120$
   039F FE 02         [ 7]  744 	cp	a,#0x02
   03A1 28 19         [12]  745 	jr	Z,00101$
   03A3 FE 03         [ 7]  746 	cp	a,#0x03
   03A5 28 2D         [12]  747 	jr	Z,00103$
   03A7 FE 04         [ 7]  748 	cp	a,#0x04
   03A9 28 35         [12]  749 	jr	Z,00104$
   03AB FE 06         [ 7]  750 	cp	a,#0x06
   03AD CAr32r04      [10]  751 	jp	Z,00114$
   03B0 FE 07         [ 7]  752 	cp	a,#0x07
   03B2 CAr3Fr04      [10]  753 	jp	Z,00115$
   03B5 D6 09         [ 7]  754 	sub	a, #0x09
   03B7 28 0F         [12]  755 	jr	Z,00102$
   03B9 C3r4Cr04      [10]  756 	jp	00116$
                            757 ;src/main.c:320: case STATE_MENU:
   03BC                     758 00101$:
                            759 ;src/main.c:321: state = menu();
   03BC CDr0Fr01      [17]  760 	call	_menu
   03BF FD 21r00r00   [14]  761 	ld	iy,#_state
   03C3 FD 75 00      [19]  762 	ld	0 (iy),l
                            763 ;src/main.c:322: break;
   03C6 18 CF         [12]  764 	jr	00118$
                            765 ;src/main.c:324: case STATE_REDEFINE:
   03C8                     766 00102$:
                            767 ;src/main.c:325: state = redefine_keys();
   03C8 CDr44r02      [17]  768 	call	_redefine_keys
   03CB FD 21r00r00   [14]  769 	ld	iy,#_state
   03CF FD 75 00      [19]  770 	ld	0 (iy),l
                            771 ;src/main.c:326: break;
   03D2 18 C3         [12]  772 	jr	00118$
                            773 ;src/main.c:328: case STATE_HELP:
   03D4                     774 00103$:
                            775 ;src/main.c:329: state = help();
   03D4 CDr4Dr02      [17]  776 	call	_help
   03D7 FD 21r00r00   [14]  777 	ld	iy,#_state
   03DB FD 75 00      [19]  778 	ld	0 (iy),l
                            779 ;src/main.c:330: break;
   03DE 18 B7         [12]  780 	jr	00118$
                            781 ;src/main.c:332: case STATE_GAME:
   03E0                     782 00104$:
                            783 ;src/main.c:333: level=1;
   03E0 21r00r00      [10]  784 	ld	hl,#_level + 0
   03E3 36 01         [10]  785 	ld	(hl), #0x01
                            786 ;src/main.c:334: user_init_level();
   03E5 CDr00r00      [17]  787 	call	_user_init_level
                            788 ;src/main.c:336: set_score(0);
   03E8 21 00 00      [10]  789 	ld	hl,#0x0000
   03EB E5            [11]  790 	push	hl
   03EC 21 00 00      [10]  791 	ld	hl,#0x0000
   03EF E5            [11]  792 	push	hl
   03F0 CDr00r00      [17]  793 	call	_set_score
   03F3 F1            [10]  794 	pop	af
   03F4 F1            [10]  795 	pop	af
                            796 ;src/main.c:338: while ((state!=STATE_LOSE) && (state!=STATE_WIN) && (state!=STATE_MENU)) {
   03F5                     797 00111$:
   03F5 3Ar00r00      [13]  798 	ld	a,(#_state + 0)
   03F8 FE 07         [ 7]  799 	cp	a,#0x07
   03FA 28 9B         [12]  800 	jr	Z,00118$
   03FC FE 06         [ 7]  801 	cp	a,#0x06
   03FE 28 97         [12]  802 	jr	Z,00118$
   0400 D6 02         [ 7]  803 	sub	a, #0x02
   0402 28 93         [12]  804 	jr	Z,00118$
                            805 ;src/main.c:343: state = game();
   0404 CDr56r02      [17]  806 	call	_game
   0407 FD 21r00r00   [14]  807 	ld	iy,#_state
   040B FD 75 00      [19]  808 	ld	0 (iy),l
                            809 ;src/main.c:349: if (state==STATE_LEVELUP)
   040E 3Ar00r00      [13]  810 	ld	a,(#_state + 0)
   0411 D6 08         [ 7]  811 	sub	a, #0x08
   0413 20 0A         [12]  812 	jr	NZ,00106$
                            813 ;src/main.c:350: state=level_up();
   0415 CDr47r02      [17]  814 	call	_level_up
   0418 FD 21r00r00   [14]  815 	ld	iy,#_state
   041C FD 75 00      [19]  816 	ld	0 (iy),l
   041F                     817 00106$:
                            818 ;src/main.c:351: if (state==STATE_DEAD){
   041F 3Ar00r00      [13]  819 	ld	a,(#_state + 0)
   0422 D6 0B         [ 7]  820 	sub	a, #0x0B
   0424 20 CF         [12]  821 	jr	NZ,00111$
                            822 ;src/main.c:352: state=end();
   0426 CDr4Ar02      [17]  823 	call	_end
   0429 FD 21r00r00   [14]  824 	ld	iy,#_state
   042D FD 75 00      [19]  825 	ld	0 (iy),l
   0430 18 C3         [12]  826 	jr	00111$
                            827 ;src/main.c:357: case STATE_WIN:
   0432                     828 00114$:
                            829 ;src/main.c:358: state = win();
   0432 CDr50r02      [17]  830 	call	_win
   0435 FD 21r00r00   [14]  831 	ld	iy,#_state
   0439 FD 75 00      [19]  832 	ld	0 (iy),l
                            833 ;src/main.c:359: break;
   043C C3r97r03      [10]  834 	jp	00118$
                            835 ;src/main.c:361: case STATE_LOSE:
   043F                     836 00115$:
                            837 ;src/main.c:362: state = game_over();
   043F CDr53r02      [17]  838 	call	_game_over
   0442 FD 21r00r00   [14]  839 	ld	iy,#_state
   0446 FD 75 00      [19]  840 	ld	0 (iy),l
                            841 ;src/main.c:363: break;
   0449 C3r97r03      [10]  842 	jp	00118$
                            843 ;src/main.c:365: default:
   044C                     844 00116$:
                            845 ;src/main.c:366: state = STATE_EXIT;
   044C 21r00r00      [10]  846 	ld	hl,#_state + 0
   044F 36 05         [10]  847 	ld	(hl), #0x05
                            848 ;src/main.c:368: }
   0451 C3r97r03      [10]  849 	jp	00118$
   0454                     850 00120$:
                            851 ;src/main.c:376: return 0;  
   0454 21 00 00      [10]  852 	ld	hl,#0x0000
   0457 C9            [10]  853 	ret
                            854 	.area _CODE
                            855 	.area _INITIALIZER
   0000                     856 __xinit__level:
   0000 00                  857 	.db #0x00	; 0
                            858 	.area _CABS (ABS)
